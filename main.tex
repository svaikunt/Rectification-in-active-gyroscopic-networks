\documentclass[
 preprint,
 preprintnumbers,
 amsmath,amssymb,
 aps,
 pre,
 longbibliography,
 superscriptaddress,
 10pt, twocolumn
]{revtex4-1}



\usepackage{graphicx}% Include figure files
\graphicspath{{./figures/}} % path to figures
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{hyperref}% add hypertext capabilities
\usepackage{physics} % package for physics symbols
\usepackage{color}
\begin{document}
% define commands
\newcommand{\eqnname}{Eq.}
\newcommand{\secname}{Sec.}


\title{Rectification of energy and motion in non-equilibrium parity violating metamaterials}


\author{Zhenghan Liao}
\affiliation{Department of Chemistry, University of Chicago, Chicago, IL, 60637, USA}
\author{William T. M. Irvine}
\affiliation{Department of Physics, University of Chicago, Chicago, IL 60637, USA}
\affiliation{James Franck Institute, University of Chicago, Chicago, IL 60637, USA}
\affiliation{ Enrico Fermi Institute, University of Chicago, Chicago, IL, 60637, USA}
\author{Suriyanarayanan Vaikuntanathan}
\affiliation{Department of Chemistry, University of Chicago, Chicago, IL, 60637, USA}
\affiliation{James Franck Institute, University of Chicago, Chicago, IL 60637, USA}


\begin{abstract}
Uncovering new design principles for rectification of stochastic fluctuations has been a longstanding problem in non-equilibrium statistical mechanics. Here, using a model parity violating metamaterial that is allowed to interact with a bath of active energy consuming particles, we develop a set of design principles for rectification of energy and motion. Our model active metamaterial can generate energy flows through an object in the absence of any temperature gradients. The nonreciprocal microscopic fluctuations responsible for generating the energy flows can further be used to power locomotion in, or exert forces on, a viscous fluid. Taken together, our analytical and numerical results elucidate how the geometry and inter-particle interactions of the parity violating material can couple with the non-equilibrium fluctuations of an active bath and enable rectification of energy and motion.  
\end{abstract}

\maketitle

\section{Introduction} \label{sec:intro}

Uncovering principles that can enable the rectification of stochastic fluctuations has been a long standing problem in non-equilibrium statistical mechanics ~\cite{Seifert2012StochasticThermodynamics,Coskun2011GreatExpectations}. The Feynman Ratchet and pawl model, and its associated generalizations, have elucidated how systems can rectify stochastic fluctuations and act as microscopic engines that perform work and exert forces~\cite{Jarzynski1999FeynmanRatchet}. Indeed such models have provided a framework to understand how biological molecular motors can convert the energy derived from the hydrolysis of energy rich molecules into mechanical work~\cite{Mogilner1996CellMotility,Chernyak2008PumpingRestriction,Rahav2008DirectedFlow,Sinitsyn2007UniversalGeometric}. While these advances provide powerful design principles, especially for rectification in single-body systems, we still have very few design principles to engineer rectification in many body systems~\cite{Seifert2012StochasticThermodynamics,Pietzonka2019AutonomousEngines}. Such principles can, for instance, identify methods to manipulate the flow of energy across materials without any imposed temperature biases~\cite{Zhu2016PersistentDirectional,Zhu2018TheoryManybody,Dubi2011ColloquiumHeat,Kanazawa2013HeatConduction,Martinez2017ColloidalHeat} and potentially facilitate the development of design principles for constructing synthetic molecular motor analogues. In this paper, we show how such rectification can be achieved in parity violating many body interacting systems. In particular, we show how a parity violating metamaterial~\cite{Nash2015TopologicalMechanics} can spontaneously rectify energy and motion in the absence of any imposed gradients, when it is allowed to interact with a bath of \textit{active} particles~\cite{Marchetti2013HydrodynamicsSoft,Koumakis2013TargetedDelivery,Woodhouse2018AutonomousActuation}. 

Our choice of parity violating metamaterial is inspired by a recent work where a metamaterial composed of interacting gyroscopes was introduced~\cite{Nash2015TopologicalMechanics}. These gyroscopic metamaterials were shown to support chiral topological edge modes. The appearance of topological chiral edge modes can be explained in terms of a violation of time reversal symmetry in the microscopic equations of motion of the interacting gyroscopes~\cite{Nash2015TopologicalMechanics,Mitchell2018AmorphousTopological}. Importantly, the violation of time reversal symmetry is controlled by an interplay between the spin of the gyroscopes and the geometry of the lattice. 

In the model systems considered in this paper, such parity violating metamaterials are allowed to interact with a bath of \textit{active} particles that violate the fluctuation dissipation relation~\cite{Fodor2016HowFar}. Our central result shows how a combination of time reversal symmetry violations due to chirality, interactions between the particles of the metamaterial, and time reversal symmetry violations implicit in the single particle fluctuations of the bath that the metamaterial is in contact with, can help rectify stochastic fluctuations. Indeed, naively coupling the topological chiral metamaterial to a heat bath does not result in any fluxes or symmetry breaking on account of the Bohr-van Leeuwen theorem \cite{Pradhan2010NonexistenceClassical} that forbids any non-equilibrium currents in thermalized magnetic systems. In contrast, we find that our model system can support a directed flux of energy across the network. Unlike conventional energy flows, our energy flow does not require a temperature gradient. Moreover, we show that the {parity violating active} network can in fact pump energy through an otherwise isolated elastic object. Finally, we also show that the microscopic mechanisms responsible for this energy flow can also potentially allow the {parity violating active} network to swim in and exert forces on a viscous fluid. We analytically and numerically demonstrate these results for a wide variety of network geometries thus establishing the generality of our results. In particular, we construct an intuitive diagrammatic approach for computing the energy flux (and consequently the swim speed) that shows how our results can readily applied to tailor flows in arbitrarily complex networks. Taken together, our results establish a new set of design principles for rectification of energy, motion and forces in non-equilibrium parity violating metamaterials. Our design principles, unlike many existing prescriptions, exploit inherent asymmetries in the geometry and interactions of the material to achieve rectification.

The remainder of this paper is organized as follows:
In \secname~\ref{sec:model}, we introduce our model parity violating metamaterial and provide a microscopic definition for the energy flux.
In \secname~\ref{sec:linear_response}-\ref{sec:path} we analytically identify the ingredients for rectification of energy fluxes and construct a diagrammatic approach that reveals a relationship between energy flux and network geometries.
Finally in \secname~\ref{sec:passive}-\ref{sec:swimmer} we show that when the particles transmitting the energy flux are allowed to interact with a viscous low Reynolds number (Re) fluid, the nonreciprocal motions responsible for the energy flux can be rectified to pump the viscous fluid. 

\section{Model systems and energy flux} \label{sec:model}
%\section{Energy flux definition and results} \label{sec:flux}

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.48\textwidth]{model_and_result.pdf}
    \caption{
    The model and the energy flux in exemplary networks.
    (a) Schematic of the model, a spring-mass network with Lorentz-like force and active bath on each particle.
    (b) Averaged energy flux from numerical calculations for a few typical networks. The flux direction and pattern can be controlled by the network geometry. In these figures, gray lines and dots represent the mechanical equilibrium structure of the network, and the size of the arrows is proportional to the magnitude of the averaged energy flux. The arrows are colored blue if it is counter-clockwise (CCW), red if clockwise (CW), and gray for fluxes not on the boundary. The numerical calculations were performed with all parameters set to $1$.
    }
    \label{fig:model_and_result}
\end{figure}

Our model parity violating metamaterial is a spring-mass network with Lorentz-like force and active bath \cite{Fodor2016HowFar} on each site (\figurename~\ref{fig:model_and_result}a).
The equation of motion reads
\begin{equation} \label{eqn:GLE_single}
    m\dot{\bm{v}}_i = -k_g \bm{z}_i + \sum_j\bm{F}_{ji} + \bm{v}_i\times\bm{B} - \gamma\bm{v}_i + \bm{\eta}_i ,
\end{equation}
where $z_i \equiv \begin{pmatrix} x_i & y_i \end{pmatrix}^T$ is the displacement of particle $i$ from its mechanical equilibrium position.

The first three terms on the right-hand side describe a spring-mass network with Lorentz force.
The first term is the on-site restoring force.
The second term is the spring force from the bonded neighbors $j$'s,
$F_{ji} = k (e_{ij}^T z_i + e_{ji}^T z_j) (-e_{ij})$, where $e_{ij}$ is the unit vector from the equilibrium position of $i$ to that of $j$. The force is linearized by assuming the natural length of springs are much larger than the scale of the particle displacement.
The third term $\bm{v}_i\times\bm{B}$ is the Lorentz-like force (the electric charge-like factor is absorbed in $\bm{B}$), and we set $\bm{B} = -B\mathbf{\hat{z}}$.
The construction of our model system is motivated by the recently constructed topological gyroscopic metamaterials \cite{Nash2015TopologicalMechanics}. Indeed, in the linearized regime, the equations of our model system are equivalent to the equations of motion of the gyroscopic metamaterials~\cite{Lee2018TopologicalDynamics}.

The last two terms describe the active bath, which consists of friction $-\gamma v_i$ and an Ornstein-Uhlenbeck (OU) colored noise $\eta_i$~\cite{Fodor2016HowFar}.
The colored noise has finite correlation time $\tau$ with statistics
\begin{equation} \label{eqn:noise_correlation}
    \expval{\eta_i(t)\eta_{j}^T(t')} = I\delta_{ij}\frac{\gamma T_a}{\tau} e^{-\frac{|t-t'|}{\tau}} ,
\end{equation}
where, for fixed $\tau$, the parameter $T_a$ controls the variance of the colored noise, and $I$ is the identity matrix with appropriate dimensions.
The time evolution of the OU noise can be described according to the following equation~\cite{Hanggi1994ColoredNoise},
\begin{equation} \label{eqn:noise_eom}
    \tau \dot{\eta}_i = -\eta_i + \sqrt{2\gamma T_a}\xi_i ,
\end{equation}
where $\xi_i$ is a delta function correlated white noise with unit variance.
The friction $-\gamma v_i$ and OU noise $\eta_i$ break fluctuation-dissipation relation, thus driving the system out of equilibrium~\cite{Fodor2016HowFar}.
The active bath reduces to a thermal equilibrium bath in the $\tau \rightarrow 0$ limit.



The observable we mainly focus on is the time-averaged energy flux between particles at steady state. For a system with pairwise interactions and on-site potentials, the energy flux $\expval{J_{ij}}$ from particle $i$ to $j$ reads
\begin{equation} \label{eqn:flux_def}
    \expval{J_{ij}} = \expval{\frac{1}{2} (\mathbf{v}_j \cdot \mathbf{F}_{ij} - \mathbf{v}_i \cdot \mathbf{F}_{ji})}
    = \expval{\mathbf{v}_j \cdot \mathbf{F}_{ij}}.
\end{equation}
To arrive at this formula, we first define the energy of a particle as the sum of its kinetic energy, on-site potential energy, and one half of the bond energies \cite{Lepri2003ThermalConduction}. Then we write down the energy balance relations using ideas from stochastic energetics~\cite{Sekimoto1998LangevinEquation}. Finally we identify the energy exchanged due to particle-particle interactions as the energy flux $\expval{J_{ij}}$ (derived in detail in the supplemental material \cite{SupplementalMaterial}).
We note that the energy flux can simply be interpreted as the rate at which work is done on particle $j$ by particle $i$.
Since this microscopic work is due to particles' stochastic motions, rather than due to an external control, the energy flux can also be interpreted as a heat flux \cite{Sekimoto1998LangevinEquation,Lepri2003ThermalConduction}. The averaged energy fluxes \eqnname~\eqref{eqn:flux_def} are identically equal to zero for a system at equilibrium with Boltzmann distribution.

Starting from the linear equations \eqnname~\eqref{eqn:GLE_single}, \eqref{eqn:noise_eom}, the energy fluxes can be solved numerically using methods introduced in \cite{Gardiner2009ItoCalculus,Ceriotti2010ColoredNoiseThermostats} (Supplemental Material \cite{SupplementalMaterial}).
A collection of numerical results are shown in \figurename~\ref{fig:model_and_result}b. We see nonzero energy rectification or energy fluxes can be generated in our chiral active system, and the flux direction or pattern changes with the network geometry.
Using a linear response theory, we now develop analytical expressions for the energy flux. These expressions reveal how a combination of chirality, non-equilibrium activity, and network geometry is responsible for generating energy fluxes.


\section{Linear response theory for energy flux} \label{sec:linear_response}
We begin by writing the equations of motion, \eqnname~\eqref{eqn:GLE_single}, in frequency space,
\begin{gather}
    \tilde{z}(\omega) = G^+(\omega) \tilde{\eta}(\omega), \label{eqn:response} \\
    G^{+}(\omega) \equiv [K + i\omega(\gamma I + BA) - m\omega^2I]^{-1}\,. \label{eqn:response_G}
\end{gather}
Here, we have represented the displacement of all particles using a column vector $z=\sum_i \ket{i}\otimes z_i$, with $\ket{i}$ denoting the 2D subspace of particle $i$. $\tilde{z}(\omega)$ and $\tilde{\eta}(\omega)$ denote the Fourier transform of $z$ and the OU noise $\eta$, respectively. $G^+$ is the response matrix, in which matrix $K$ encodes all on-site and spring forces $F$ according to $F=-Kz$, and $A$ is an antisymmetric matrix $A=\sum_i \ket{i}\bra{i}\otimes \mqty(0 & 1 \\ -1 & 0)$. \eqnname~\eqref{eqn:response} describes how the displacement responds to the noise.

Following the procedure in \cite{Kundu2011LargeDeviations}, the flux defined in \eqnname~\eqref{eqn:flux_def} can be expressed using $G^+$ as a spectral integral (Supplemental Material \cite{SupplementalMaterial})
\begin{align}
    \expval{J} &= \int_{-\infty}^\infty \dd{\omega} h(\omega) J^{FT}(\omega), \label{eqn:flux_integral} \\
    J^{FT}(\omega) &\equiv -\frac{T_a k}{2\pi} \Re \tr G^+(\omega)A^{as}, \\
    h(\omega) &= \frac{1}{1+\omega^2\tau^2},
\end{align}
where $A^{as}$ is an antisymmetric matrix
$A^{as} = -\ket{i}\bra{j} \otimes e_{ij}e_{ji}^T + \ket{j}\bra{i} \otimes e_{ji}e_{ij}^T$.
The response function $G^+(\omega)$ has no pole in the lower-half complex plane, but the colored noise introduces one pole at $\omega = -i/\tau$. Using the residue theorem we get a compact expression for the energy flux (Supplemental Material \cite{SupplementalMaterial})
\begin{equation} \label{eqn:flux_residue}
    \frac{\expval{J}}{T_a/\tau} = -\frac{k}{2} \tr G^+(-\frac{i}{\tau})A^{as} .
\end{equation}
\eqnname~\eqref{eqn:flux_integral} and \eqref{eqn:flux_residue} will serve as our starting point to understand the energy flux. While they contain all the information required to compute energy fluxes, they have limited utility as design principles. Indeed, as written down, they require that the flux be recomputed de novo for each new network geometry and non-equilibrium bath activity. In the next sections, we show that it is possible to expand \eqnname~\eqref{eqn:flux_integral} and \eqref{eqn:flux_residue} in forms that reveals design principles for controlling energy fluxes.

As an side, one important property that can be directly obtained from a similar linear response analysis is that the energy fluxes satisfy Kirchoff's law, $\sum_i \expval{J_{ij}} = 0$. The Kirchoff's law shows that on average there is no energy exchange between particles and the active bath. 
To derive the Kirchoff's law, we calculate the average heat exchange between particle $i$ and the active bath $\expval{\bm{v}_i \cdot \bm{\eta}_i - \gamma \bm{v}_i \cdot \bm{v}_i}$, and following procedures in \cite{Kundu2011LargeDeviations}, this heat exchange can be shown to be zero.
The Kirchoff's law puts a strong constraint on possible energy flux patterns among particles, and some corollaries immediately follow, such as networks with no cycles cannot have nonzero flux, and fluxes of all bonds in a polygon network (as in \figurename~\ref{fig:model_and_result}b) are equal.



\section{Ingredients for energy rectification and their roles} \label{sec:fourier}

Compared with an ordinary thermal spring-mass network, that supports no energy fluxes in its equilibrium steady state, our parity violating metamaterial contains two extra components, the Lorentz force and the correlation in the noise, \eqnname~\ref{eqn:noise_eom}.
We first show that these two components provide two necessary ingredients required to ensure energy rectification in our model. Next, we show how the geometry of the network also controls the energy flux. 



\subsection{Lorentz force and non-equilibrium activity are necessary for the generation of an energy flux} 

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.48\textwidth]{ingredients.pdf}
    \caption{
    Necessary ingredients for generating nonzero energy fluxes.
    Both Lorentz-like force and colored noise are needed to generate nonzero fluxes.
    The role of Lorentz-like force is to provide chiral Fourier modes ($J^{FT}(\omega)\neq 0$). If $B=0$, $J^{FT}(\omega)$ is zero everywhere. 
    The role of colored noise is to provide weighted excitation $h(\omega)\neq \text{const.}$, which makes a non-vanishing averaged flux $\expval{J}$ possible.
    The numerical calculations were performed with $m,k_g,\gamma,k, T_a=1$. 
    }
    \label{fig:ingredients}
\end{figure}
We begin with \eqnname~\eqref{eqn:flux_integral} that represents the averaged flux in terms of functions $J^{FT}(\omega), h(\omega)$. In particular, we note that the function $J^{FT}(\omega)$ is proportional to the energy flux at Fourier frequency $\omega$ in an isolated damped variant of our network while the function $h(\omega)$ is proportional to the the noise spectrum, $\expval{\tilde{\eta}(\omega)\tilde{\eta}^*(\omega)} = 2\gamma T_a h(\omega) / t$.

To generate a nonzero flux, or equivalently make the integral nonzero in \eqnname~\eqref{eqn:flux_integral}, we need two requirements (\figurename~\ref{fig:ingredients}).
Firstly, $J^{FT}(\omega)$ should not be zero everywhere.
In the absence of a magnetic field, $B=0$, it can be easily shown from \eqnname~\ref{eqn:flux_integral} that $J^{FT}(\omega)=0$. Indeed, the response function $G^+$ is symmetric or reciprocal in this case, and since $A^{as}$ is antisymmetric, the trace $\tr G^+(\omega) A^{as}=0$ at all values of $\omega$. Nonzero $B$ breaks the reciprocity of $G^+$, and can thus generate a nonzero $J^{FT}(\omega)$. 

Nonzero $J^{FT}(\omega)$ alone does not ensure a nonzero averaged energy flux, we further require that $h(\omega)$ not be constant.
Indeed, noise characterized by a constant $h(\omega)$ function corresponds to fluctuation dissipation preserving white noise. In such cases, our model system would be in equilibrium even in the presence of a magnetic field according to the Bohr-van Leeuwen theorem \cite{Pradhan2010NonexistenceClassical}.
A non constant $h(\omega)$ function corresponding to a colored noise source, such as the fluctuation dissipation violating OU noise, $h(\omega)=1/(1+\omega^2\tau^2)$, can support a non-zero average energy flux. 

In summary, we see that $B$-field, and a colored noise are two necessary ingredients to generate flux in our model chiral systems.
The role of the $B$-field is to break the reciprocity of response and generate Fourier modes such that $J^{FT}(\omega)\neq 0$. The role of the colored noise is to excite these modes in a weighted manner.

\subsection{Energy flux can be tuned as a function of lattice geometry} 
Apart from the these two ingredients, the geometry of the network also plays an important role.
Indeed in the small $\gamma$ regime, the existence of chiral modes with $J^{FT}(\omega)\neq 0$ can be heuristically explained by exploiting the connection between the slightly damped isolated variants of our system and the undamped isolated gyroscopic metamaterials~\cite{Nash2015TopologicalMechanics,Mitchell2018AmorphousTopological}.
Specifically, the slightly damped variant resonate near the eigen-frequencies of the undamped metamaterials, and hence exhibit Fourier modes that are close to the eigenmodes of the undamped system. Consequently, we infer that $J^{FT}(\omega)\neq 0$ as long as the corresponding eigenmodes in the undamped variant are chiral. As discussed in  \cite{Nash2015TopologicalMechanics}, the geometry of the network plays a crucial role in generating the chiral eigenmodes.
At larger $\gamma$'s, the Fourier modes of our damped isolated variant are no longer close to the chiral eigenmodes of gyroscopic metamaterials, but a connection between eigenmodes and energy fluxes can still be built (Supplemental Material \cite{SupplementalMaterial}).
In the next section, we further elaborate the role of geometry. Specifically, the central results of the next section provide compact expressions that elucidate the role played by geometry, Lorentz forces and non-equilibrium activity.


\section{Relationship between flux and network geometry} \label{sec:path}
\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.48\textwidth]{path_sum.pdf}
    \caption{Illustrations of our diagrammatic technique.
    (a) Flux from $1$ to $2$ can be calculated by summing over paths. Each path is a pictorial representation of one term in the small-$k$ expansion, and is depicted using green arrows. The magnitude of path with length $n$ is on the order of $k^n$.
    (b) Schematic of a polygon path and its outer angles $\theta_1,\theta_2,\dots,\theta_n$. The flux of this path is simply \eqnname~\eqref{eqn:flux_path_polygon}.
    (c) For flux in complex networks, the leading order term is determined by the shortest cycles. Flux in the triangle part has order $k^3$, and the pre-factor $c_3$ is the same as that in a standalone triangle network. Likewise for the pentagon part. As a result, the flux in a complex network can be viewed as a combination of fluxes in its constituent cycles.
    }
    \label{fig:path_sum}
\end{figure}

In this section we develop a diagrammatic technique, which provides a simple intuitive method to compute energy fluxes and reveals a relationship between flux and network geometry.
The diagrammatic technique is constructed by expanding the expressions for the energy flux \eqnname~\eqref{eqn:flux_residue} in small-$k$ regime and shows how the energy flux across a bond can be expressed as a sum over paths traversed along the network (\eqnname~\eqref{eqn:flux_path}). Our perturbation theory assigns a geometry dependent pre-factor for each path, thus elucidating the role played by network geometry in ensuring rectified energy fluxes (\eqnname~\eqref{eqn:flux_path_polygon}). Together, the central results of this section, summarized in  \eqnname~\ref{eqn:flux_path}, \eqnname~\ref{eqn:flux_path_polygon} provide compact expressions that elucidate how geometry, $B$-field, and correlation time $\tau$ of the colored noise can combine to generate energy flows in networks with arbitrarily complex geometry and topologies. Crucially through this diagrammatic approach we demonstrate that the energy flux is controlled by the local geometry of the lattice. This result is surprising given the non local dependence suggested by \eqnname~\ref{eqn:flux_residue}. The diagrammatic techniques developed here enable the efficient control energy flux patterns in arbitrarily complex networks. 
%Although these quantitative conclusions are based on small-$k$ expansion, they also qualitatively agree with many numerical examples at larger $k$'s.


\subsection{Path summation and its rules}
Starting from the flux formula \eqnname~\eqref{eqn:flux_residue}, one can expand the flux to different orders in the spring constant $k$. Then for each order, one can further collect contributions from various paths.
As a result, the total flux can be written as a sum over the flux of paths (\figurename~\ref{fig:path_sum}a), (Supplemental Material \cite{SupplementalMaterial})
\begin{equation} \label{eqn:flux_path}
    \frac{\expval{J}}{T_a/\tau} = \sum_l J^\text{path}_l = \sum_l \frac{1}{2}(S_l - S_{-l}).
\end{equation}

The path rules are as follows.
For the flux from $i$ to $j$, valid paths are $l=i\rightarrow j\rightarrow l_3\rightarrow l_4\rightarrow \dots \rightarrow l_n\rightarrow i$, where $l_a$ and $l_b$ either has to be bonded or $l_a=l_b$. Paths that contain equal numbers of $i\rightarrow j$ and $j\rightarrow i$ do not contribute (e.g. path $i\rightarrow j\rightarrow i$), because either the path itself vanishes or it cancels with another path. As a result, paths appear as cycles.
The term $S_l$ is defined as $S_l \equiv (k/k_0)^n \tr R_\alpha (-K_s)_{i l_n} \cdots R_\alpha (-K_s)_{l_3j} R_\alpha (-K_s)_{ji}$.
In this definition, $k_0\equiv \sqrt{(k_g+\gamma/\tau+m/\tau^2)^2 + (B/\tau)^2}$ sets a characteristic scale for spring constant $k$. $R_\alpha \equiv \pmqty{\cos\alpha & -\sin\alpha \\ \sin\alpha & \cos\alpha}$ is a CCW rotation matrix. The angle $\alpha$ is defined as
\begin{equation} \label{eqn:path_alpha_def}
    \alpha \equiv \arcsin{\frac{B/\tau}{k_0}}.
\end{equation}
We note that all parameters ($m,k_g,k,B,\gamma,\tau$) are condensed into this single angle $\alpha$.
$(K_s)_{l_b l_a} \equiv \bra{l_b}(K-k_gI)\ket{l_a} / k$ is a $2\times 2$ submatrix used to calculate the non-dimensionalised spring force on $l_b$ due to the displacement of $l_a$.
$-l$ means $l$ in the reversed order.
The interval of convergence depends on the geometry of the whole network as well as the parameter $\alpha$. The typical value of the upper bound of $k/k_0$ ranges between $0.3$ and $0.6$.

The paths can be represented using diagrams, from which the flux $J^\text{path}_l$ can be calculated easily. For instance, the first diagram in \figurename~\ref{fig:path_sum}a represents the path $1\rightarrow 2\rightarrow 3\rightarrow 1$. To calculate $S_l$, one writes $(-K_s)_{l_bl_a}$ for each arrow $l_a\rightarrow l_b$, $R_\alpha$ for each node $l_a$, then multiply these matrices in the reversed order, and calculate the trace, e.g. $S_{1\rightarrow 2\rightarrow 3\rightarrow 1} = (k/k_0)^3 \tr R_\alpha (-K_s)_{13} R_\alpha (-K_s)_{32} R_\alpha (-K_s)_{21}$. To get $S_{-l}$, one takes the result of $S_l$ and replace $\alpha$ by $-\alpha$. Finally, $J^\text{path}_l$ can be calculated from the difference between $S_l$ and $S_{-l}$.

\subsection{Contributions to energy flux from polygonal paths}
Paths with length $n$ show up as terms of order $(k/k_0)^n$ in the energy flux expression. In the small $k$ regime, the main contribution to the flux comes from the lowest-order paths.
The usual lowest-order paths are polygonal cycles with no loops (loops are self-connecting edges, $l_a\rightarrow l_a$). In this case, the formula for $J^\text{path}_l$ \eqnname~\eqref{eqn:flux_path} reduces to a simple form (Supplemental Material \cite{SupplementalMaterial})
\begin{equation} \label{eqn:flux_path_polygon}
    J^\text{path}_\text{polygon} = \frac{1}{2} (\frac{k}{k_0})^n (\prod_i \cos(\theta_i - \alpha) - \prod_i \cos(\theta_i + \alpha)),
\end{equation}
where $\alpha$ is defined in \eqnname~\eqref{eqn:path_alpha_def}, $n$ is the number of nodes and $\theta_i$'s are outer angles (\figurename~\ref{fig:path_sum}b).
\eqnname~\ref{eqn:flux_path_polygon} illustrates how geometry of the network, as characterized by the angles $\theta_i$, together with the condensed parameter $\alpha$ that encodes the nonreciprocity due to the $B$ field and the violation of fluctuation dissipation due to the colored noise, combine to generate energy fluxes.

For polygon networks, \eqnname~\eqref{eqn:flux_path_polygon} gives a direct relationship between the lowest-order flux and the network geometry. As an example, flux in an arbitrary triangle is $J \propto k^3 \sin\theta_1\sin\theta_2\sin\theta_3 + \mathcal{O}(k^4)$, whose $k^3$ term is always positive or CCW.
For complex networks, \eqnname~\eqref{eqn:flux_path_polygon} implys that its lowest-order flux can be viewed as a result of combining the flux of its constituent polygons, as illustrated in \figurename~\ref{fig:path_sum}c. This is because the flux of a polygonal path \eqnname~\eqref{eqn:flux_path_polygon} is not affected by any side chains on the nodes, and $J^\text{path}_\text{polygon}$ for a polygon in a complex network is the same as $J^\text{path}_\text{polygon}$ for the polygon when standalone.

Starting from the  diagrammatic expansion, the presence of localized energy fluxes in some networks (\figurename~\ref{fig:model_and_result}b) can be readily understood. Consider for instance the paths contributing to flux along an edge in a honeycomb-like network. Away from the boundary, the lower order path contributions to the energy flux cancel each other, and higher order path contributions become dominant. The size of the leading order path that contributes to the energy flux along a bond increases as a function of the distance of the bond from boundary. Such a scaling results in an exponential localization of the energy flux at the boundary of the network.

At the outset, given the long ranged nature of elastic fluctuations, one might expect that the fluxes depend on topology in a highly non local manner. Indeed, the expressions for flux in \eqnname~\ref{eqn:flux_residue} suggest a complex non local connection between the flux and the topology of the network. The results of this section show, however, that the flux can be in fact be controlled using effectively local rules. Hence, using the diagrammatic decomposition introduced here, it is easy to program energy flux patterns in networks of arbitrary complexity. Our diagrammatic expansion hence allows us to go beyond the need for de novo calculations suggested by our previous equations.

\section{Energy flux in a passive segment coupled to an active network} \label{sec:passive}
\label{sec:passiveflux}
We expect that our parity violating metamaterial can still generate energy fluxes when some nodes along the transmission pathway are made {\it passive} (i.e. uncoupled from the active bath and magnetic field).
Mimicking conventional paradigms to study heat conduction, which consider a passive chain between two thermal baths with different temperatures (\figurename~\ref{fig:simulation}a), we connect a passive harmonic chain to our active parity violating metamaterial (\figurename~\ref{fig:simulation}a).
We indeed find that our active parity violating metamaterial is able to generate a nonzero averaged energy flux through the passive material (\figurename~\ref{fig:simulation}, Supplemental Video \cite{SupplementalMaterial}). The instantaneous flux transmitted across the bonds on the passive segment are plotted in \figurename~\ref{fig:simulation}b (accompanying Supplemental Video \cite{SupplementalMaterial}). The instantaneous flux exhibits stochastic fluctuations. Large values of the instantaneous flux are transmitted across bonds sequentially in a wave like manner (\figurename~\ref{fig:simulation}b). This is reflected in the successive peaks in the instantaneous flux profile across the bonds of the passive segment.  The spacing between the peaks matches the sound speed in the passive chain. This result, in combination with the results of the previous sections, shows how one design active parity violating metamaterials that can act as energy pumps and support energy transport in passive materials even in the absence of any temperature gradients. 

In effect, these results demonstrate how parity violating metamaterials can rectify non-equilibrium fluctuations in potentially novel ways. In the next section, we show that these rectified energy flows can in turn be used, in principle, to exert forces and rectify motion. In particular, the energy fluxes through the passive segment, especially the successive flux peaks observed in the above simulation, seem to suggest that stochastic wave like collective oscillations play an important role in the energy transfer process. System with nonreciprocal wave-like fluctuations when placed in contact with a viscous fluid, can act as low $Re$ swimmers \cite{Taylor1951AnalysisSwimming,Purcell1977LifeLow,Golestanian2008AnalyticResults}. Thus, the nonreciprocal motion in the passive segment could potentially be exploited as a strategy to enable locomotion. 



%During the period when the instantaneous flux $J$ is large, $J$ exhibits successive peaks, indicating a large CCW energy flow.
\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.48\textwidth]{simulation_j.pdf}
    \caption{
    Driving energy through a passive chain.
    (a) Conventional heat conduction in a chain with temperature differences at two ends. The temperature difference drives a heat flow through a passive material (boxed in gray).
    Similarly, the active gyroscopic network can also drive energy flows through a passive segment.
    (b) Instantaneous energy flux $J$ through bonds in the passive segment in a simulation. Flux through different bonds are colored differently. $J$ is random in general, however, during the period when $J$ is large, as shown in the inset, $J$ exhibits successive peaks in accordance with the direction of the flux.
    In the simulation setup, parameters for the active particles are: $m,k_g,\gamma=0.1, k=10, B,T_a,\tau=1$. Passive particles (boxed in gray) are constrained to 1D, and their $\gamma,T_a,k_g$ are set to $0$.
    }
    \label{fig:simulation}
\end{figure}

\section{Non-reciprocal motions responsible of energy fluxes can be used to generate forces} \label{sec:swimmer}




The rectification of energy has been our main focus so far. In this section, we show that it possible to exploit the energy flux to rectify motions when our model systems are allowed to interact with a viscous fluid (\figurename~\ref{fig:swimmer}a).
We begin by considering the setup of the previous section where a {\it passive} segment is coupled to our active metamaterial, and consequently supports an energy flux.
We first use the motion of this segment as input to construct a time dependent protocol to modulate the configuration of an equivalent segment that is disconnected from the network and placed in a viscous fluid. We find that doing so creates a low Reynolds number ($Re$) swimmer (or equivalently a pump if the network is held fixed). Using the diagrammatic theory introduced in \secname~\ref{sec:path}, we show that the swimming speed is in fact proportional to the energy flux. This calculation ignores any back action from the fluid on the dynamics of the segment. We consider the effect of these forces in \secname~\ref{sec:pumping} and discuss regimes in which our energy conducting passive segment can generate forces when immersed in a viscous fluid. Together, these results demonstrate how a parity violating active metamaterial can be manipulated to exert forces and power motion in nanoscale materials.  

\begin{figure}[tbp]
	\centering
	\includegraphics[width=0.48\textwidth]{swimmer.pdf}
    \caption{Utilization of non-equilibrium parity violating dynamics to power swimming and pumping in low Reynolds number ($Re$) media.
    (a) The energy flux in the active parity violating network is accompanied by nonreciprocal motions of the particles (i,ii). Using these nonreciprocal motions as input, a three bead linear object can be made to swim through a low Reynolds number ($Re$) medium (iii). Our analytical results in (b) below show that the swim speed $V_s$ is in fact proportional to the energy flux $\expval{J}$ The nonreciprocal motion is a schematic for illustration purposes, and the real data is much more noisy. (iv) Finally by immersing the passive segment into a low Reynolds fluid, the nonreciprocal motions can be used to pump the fluid. In this manner, the energy fluxes can be rectified for locomotion and force generation. 
    (b) Swimmer's speed $V_s$ is proportional to the energy flux $\expval{J}$ in the active network. The proportionality constant is $-k_0/k$, which is independent of the network geometry. The series of dots for each $-k_0/k$ are obtained by varying the labelled angles (by red disk sectors) in pentagon networks or square+tail networks. The parameters chosen for the numerical calculations are $m,k_g=0.1$, $\tau=1$, $k=5$ for $k_0/k=0.04$ and $k=10$ for $k_0/k=0.02$. For the active part, $\gamma=0.1, B,T_a=1$. For the passive segment, $\gamma,B,T_a=0$.
    }
    \label{fig:swimmer}
\end{figure}



\subsection{Nonreciprocal motion as a swimming protocol}

 We begin by considering a minimal passive elastic segment with three spheres arranged in a linear configuration~\cite{Golestanian2008AnalyticResults} (\figurename~\ref{fig:swimmer}a(iii)). We imagine instances where the passive elastic segment is disconnected from the parity violating metamaterial and immersed in a low-$Re$ fluid~\figurename~\ref{fig:swimmer}a(iii). When the lengths of the two springs connecting the spheres, $L_1(t) = L+\Delta L_1(t), L_2(t) = L+\Delta L_2(t)$ are varied according to some prescribed protocol, the time-averaged swimming speed is (\eqnname~(12) in \cite{Golestanian2008AnalyticResults})
\begin{equation} \label{eqn:swimmer_speed}
    V_s = \frac{7a}{24L^2} \expval{\Delta L_1 \dv{\Delta L_2}{t} - \dv{\Delta L_1}{t} \Delta{L_2}},
\end{equation}
where $a$ is the radius of the bead. Assumptions for this equation are $a/L \ll 1, \Delta L_i/L \ll 1$, and total external force on the swimmer is zero.


We now imagine recording the motions of the passive segment when it is connected to our parity violating metamaterial as in \secname~\ref{sec:passiveflux}(\figurename~\ref{fig:swimmer}a) and not coupled to a viscous fluid. This recorded motion can be used a protocol for modulating the configuration of an equivalent {\it swimmer} passive segment that is placed in a viscous fluid.
We compute the swimming speed $V_s$ of the swimmer using \eqnname~\ref{eqn:swimmer_speed} and find that it is in fact proportional to the energy flux, $\expval{J}$, conducted through the passive segment when it is coupled to the chiral active network (\figurename~\ref{fig:swimmer}b). The nonreciprocal motions that is responsible for energy fluxes can also be used as a protocol to generate motion in a low $Re$ fluid.
The proportionality constant between the swim speed, $V_s$ and the energy flux, $\expval{J}$, can be calculated using a modified path analysis technique (Supplemental Material \cite{SupplementalMaterial}),
\begin{equation} \label{eqn:swimmer_propto}
    \frac{V_s}{7a/24L^2} = -\frac{k_0}{k} \frac{\expval{J}}{k/2},
\end{equation}
where $k_0 = k_g + m/\tau^2$ ($B,\gamma=0$ for the passive segment).
This result \eqnname~\eqref{eqn:swimmer_propto} holds beyond small-$k$ regime because all orders of paths are considered (Supplemental Material \cite{SupplementalMaterial}).
\figurename~\ref{fig:swimmer}b and \eqnname~\eqref{eqn:swimmer_propto} together establish that one can relate the swim speed to the flux of energy in the parity violating metamaterial. 
Similar proportionality between $V_s$ and $\expval{J}$ can be expected for other types of three-sphere swimmers, such as one where one sphere is much larger than the other two \cite{Golestanian2008ThreesphereLowReynoldsnumber}. This is because the swim speed $V_s$ is generically proportional to the area enclosed in the $\Delta L_i$ space \cite{Golestanian2009StochasticLow}. This area is also proportional to the energy flux $\expval{J}$ (Supplemental Material \cite{SupplementalMaterial}).


\subsection{Force generation in a viscous medium using the rectified energy fluxes}
\label{sec:pumping}
Finally, we now consider the scenario where the passive segment, which is connected to the active network, is immersed in a fluid (\figurename~\ref{fig:swimmer}a(iv)). Since the passive segment is tethered due to $k_g$ and its connection to the active network, it cannot swim indefinitely. However, a stalled swimmer can potentially pump the fluid \cite{Leoni2009BasicSwimmer}. We now analyse the regime for parameters where this pumping is possible.
In order to utilize the connection between the swim speed and energy flux, we require that the fluid minimally perturbs the dynamics of the passive segment. Such a regime requires the dissipation rate due to the viscous fluid to be much smaller than the energy flux through the segment. This condition can be expressed as $\eta_f a v^2 \ll J$, where $v$ is the characteristic velocity of a bead in the passive segment, $\eta_f$ is the dynamic viscosity of the fluid, and $J$ is the energy flux in the absence of the fluid.
In addition, the constraint of low Reynolds number requires that $Re = \rho_f a v /\eta_f \ll 1$, where $\rho_f$ is fluid's density.
Writing these two conditions together, the requirement reads $J \gg \eta_f a v^2 \gg \rho_f a^2 v^3$. 
Here, we have ignored hydrodynamic interactions between the beads, because it is a higher-order perturbation with the order of $a/L$. 

As a numerical example, this condition can be satisfied by setting $k=5\times 10^{-5} kg/s^2, k_g=1\times 10^{-6} kg/s^2$ for springs (value of optical trap), $a=10^{-6}m$ for all beads (size used in \cite{Leoni2009BasicSwimmer}), $T_a=10^{-18} J, \tau=1s$ for the active bath \cite{Wu2000ParticleDiffusion}, $\rho_f=10^3kg/m^3, \eta_f=10^{-3}kg/(m\cdot s)$ for liquid (water), and $B=10^{-5} kg/s$ for the $B$-field.
For these parameters, we obtain $v=3.8\times 10^{-6}m/s$, and the three relevant scales $J=5\times 10^{-19}J/s, \eta_f av^2=1.4\times 10^{-22}J/s, a^2v^3\rho_f=5.4\times 10^{-29}J/s$, which indeed satisfy $J \gg \eta_f a v^2 \gg \rho_f a^2 v^3$.
If the separation between beads is $L=10^{-7}m$, the swim speed calculated from \eqnname~\eqref{eqn:swimmer_propto} is $1\times 10^{-8} m/s$. 
The swim speed can provide an estimate of the potential speed at which the fluid can be pumped due to the energy fluxes. 
This speed can be scaled up by increasing $T_a$.
We note the extremely high value of the $B$ field required to generate a sizable averaged flux $\langle J \rangle$. To make practical use of this model, we anticipate that it will become necessary to instead consider models with interacting gyroscopes~\cite{Nash2015TopologicalMechanics} or Coriolis forces \cite{Kahlert2012MagnetizingComplex}. Large Lorentz force ($B$) analogues are easier to achieve in these cases. 

In summary, the results of this section show that the energy fluxes generated by our active parity violating metamaterial can be used to rectify motion and generate forces on the nanoscale. Our calculations also show how the forces generated by our metamaterial are in fact proportional to the energy fluxes. Hence, together with the results from the previous sections that show how energy fluxes in arbitrarily complex active metamaterial networks can be controlled, our results provide a broad framework to generate and modulate forces using active parity violating metamaterials.  


\section{Conclusion} \label{sec:conclusion}

In conclusion, we have established a general set of design principles for rectifying energy and motion in non-equilibrium parity violating metamaterials. In particular, our central results show how a combination of time reversal symmetry violation due to the interactions and Lorentz forces in the metamaterial, and due to the non-equilibrium fluctuations of the active bath, can result in a general strategy for rectification of energy and motion. Extending these ideas to non-equilibrium parity violating metamaterials with non-linear interactions or materials composed of active chiral particles can potentially lead to new strategies for the construction of synthetic molecular motor analogues. These ideas will be considered in future work. 



\section*{Acknowledgements}
This work was primarily supported by NSF DMR- MRSEC 1420709. SV acknowledges support from the Sloan Foundation, startup funds from the University of Chicago and support from the National Science Foundation under award number DMR-1848306. WTMI Acknowledges support from NSF EFRI NewLAW grant 1741685 and the Packard foundation. 

\bibliography{reference}


\end{document}
